version: '3.9'


services:
db:
container_name: plataforma-db
image: mysql:8
restart: always
environment:
MYSQL_ROOT_PASSWORD: ${MYSQL_ROOT_PASSWORD:-root}
MYSQL_DATABASE: ${MYSQL_DATABASE:-plataforma_artesanal}
MYSQL_USER: ${MYSQL_USER:-root}
MYSQL_PASSWORD: ${MYSQL_PASSWORD:-root}
ports:
- "3306:3306"
volumes:
- dbdata:/var/lib/mysql
networks:
- plataforma_net


backend:
container_name: plataforma-backend
build:
context: https://github.com/radonix/BackendPlatArt.git
dockerfile: Dockerfile
restart: unless-stopped
environment:
- PORT=${BACKEND_PORT:-3001}
- DATABASE_URL=${DATABASE_URL:-mysql://root:root@db:3306/plataforma_artesanal}
- NODE_ENV=${NODE_ENV:-production}
- JWT_SECRET=${JWT_SECRET:-change_this}
ports:
- "${BACKEND_PORT:-3001}:${BACKEND_PORT:-3001}"
depends_on:
- db
networks:
- plataforma_net


frontend:
container_name: plataforma-frontend
build:
context: https://github.com/radonix/PlataformaArtesanal.git
dockerfile: Dockerfile
restart: unless-stopped
environment:
- VITE_API_URL=${VITE_API_URL:-http://localhost:${BACKEND_PORT:-3001}}
ports:
- "${FRONTEND_PORT:-80}:80"
depends_on:
- backend
networks:
- plataforma_net


volumes:
dbdata:


networks:
plataforma_net:
driver: bridge
